<config xmlns="http://tail-f.com/ns/config/1.0">
  <environments xmlns="https://curity.se/ns/conf/base">
    <environment>
      <admin-service>
        <http>
          <ssl-server-keystore>default-admin-ssl-key</ssl-server-keystore>
          <web-ui>
          </web-ui>
          <restconf>
          </restconf>
        </http>
      </admin-service>
      <services>
        <zones>
          <default-zone>
            <symmetric-key>data:text/plain;aes,v:S.cjh0VVJ0cXpFeWZQanpFeg==.JxtlzHFAAd5_Vfn6oLelBg==.P9J4hQEeubPcX9laFDkCp0NGtqoKIcf0WE2zaBN9knK22ICbBk7FKvY6-qI4ZoVanIFlw3c1lnFvxhyGtiZJBSgzgRnzBUaDcg2LwpCGbTE=.2XGGRWWkArn6BBs9VMilTq4RQgCX5CT87Iz2Bo9SQug=</symmetric-key>
          </default-zone>
        </zones>
        <service-role>
          <id>default</id>
          <ssl-server-keystore>default-admin-ssl-key</ssl-server-keystore>
          <endpoints>authentication-service-anonymous</endpoints>
          <endpoints>authentication-service-authentication</endpoints>
          <endpoints>authentication-service-registration</endpoints>
          <endpoints>token-service-anonymous</endpoints>
          <endpoints>token-service-assisted-token</endpoints>
          <endpoints>token-service-authorize</endpoints>
          <endpoints>token-service-dynamic-client-registration</endpoints>
          <endpoints>token-service-introspect</endpoints>
          <endpoints>token-service-revoke</endpoints>
          <endpoints>token-service-session</endpoints>
          <endpoints>token-service-token</endpoints>
          <endpoints>token-service-userinfo</endpoints>
          <endpoints>um-admin</endpoints>
          <endpoints>user-graphql-admin</endpoints>
        </service-role>
      </services>
    </environment>
  </environments>
  <profiles xmlns="https://curity.se/ns/conf/base">
    <profile>
      <id>authentication-service</id>
      <type xmlns:auth="https://curity.se/ns/conf/profile/authentication">auth:authentication-service</type>
      <settings>
        <authentication-service xmlns="https://curity.se/ns/conf/profile/authentication">
          <authentication-actions>
            <authentication-action>
              <id>dbug</id>
              <debug-attribute xmlns="https://curity.se/ns/ext-conf/debug-attribute"/>
            </authentication-action>
            <authentication-action>
              <id>get-user-attributes</id>
              <data-source-transformer xmlns="https://curity.se/ns/ext-conf/data-source-transformer">
                <attribute-data-source>
                  <data-source>default-datasource</data-source>
                </attribute-data-source>
              </data-source-transformer>
            </authentication-action>
          </authentication-actions>
          <authenticators>
            <authenticator>
              <id>username-password</id>
              <authentication-context-class-reference>iggbom</authentication-context-class-reference>
              <authentication-actions>
                <login>get-user-attributes</login>
              </authentication-actions>
              <html-form xmlns="https://curity.se/ns/conf/authenticators/html-form">
                <account-manager>default-account-manager</account-manager>
                <credential-manager>default-credential-manager</credential-manager>
              </html-form>
            </authenticator>
          </authenticators>
          <protocols>
            <protocol>
              <id>default-simple-protocol</id>
              <simple-api/>
            </protocol>
          </protocols>
        </authentication-service>
      </settings>
      <endpoints>
        <endpoint>
          <id>authentication-service-anonymous</id>
          <uri>/authn/anonymous</uri>
          <endpoint-kind>auth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-authentication</id>
          <uri>/authn/authentication</uri>
          <endpoint-kind>auth-authentication</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-registration</id>
          <uri>/authn/registration</uri>
          <endpoint-kind>auth-registration</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
    <profile>
      <id>token-service</id>
      <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
      <settings>
        <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
          <authorization-manager>my-xacml-authz-manager</authorization-manager>
          <authentication-service>
            <authentication-profile>authentication-service</authentication-profile>
          </authentication-service>
          <client-capabilities>
            <code>
            </code>
            <implicit/>
            <resource-owner-password-credentials>
              <credential-manager>default-credential-manager</credential-manager>
            </resource-owner-password-credentials>
            <client-credentials/>
            <introspection/>
            <token-exchange/>
          </client-capabilities>
          <scopes>
            <scope>
              <id>address</id>
              <description>OpenId Connect address scope</description>
              <claims>address</claims>
            </scope>
            <scope>
              <id>email</id>
              <description>OpenId Connect email scope</description>
              <claims>email</claims>
              <claims>email_verified</claims>
            </scope>
            <scope>
              <id>openid</id>
              <description>Standard OpenID Connect scope</description>
            </scope>
            <scope>
              <id>phone</id>
              <description>OpenId Connect phone scope</description>
              <claims>phone_number</claims>
              <claims>phone_number_verified</claims>
            </scope>
            <scope>
              <id>profile</id>
              <description>OpenId Connect profile scope</description>
              <claims>birthdate</claims>
              <claims>family_name</claims>
              <claims>gender</claims>
              <claims>given_name</claims>
              <claims>locale</claims>
              <claims>middle_name</claims>
              <claims>name</claims>
              <claims>nickname</claims>
              <claims>picture</claims>
              <claims>preferred_username</claims>
              <claims>profile</claims>
              <claims>updated_at</claims>
              <claims>website</claims>
              <claims>zoneinfo</claims>
            </scope>
            <default-scope-claim>groups</default-scope-claim>
          </scopes>
          <claims>
            <claim>
              <name>address</name>
              <description>OpenID Connect address claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>birthdate</name>
              <description>OpenID Connect birthdate claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email</name>
              <description>OpenID Connect email claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email_verified</name>
              <description>OpenID Connect email_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>family_name</name>
              <description>OpenID Connect family_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>gender</name>
              <description>OpenID Connect gender claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>given_name</name>
              <description>OpenID Connect given_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>groups</name>
              <value-provided-by>auth-subject-claims-provider</value-provided-by>
              <transformation>
                <input-attribute-names>attributes</input-attribute-names>
                <value-transformation-procedure>ZnVuY3Rpb24gdHJhbnNmb3JtKGF0dHJpYnV0ZXMpIHsKICAgIHJldHVybiBKU09OLnBhcnNlKGF0dHJpYnV0ZXMuYXR0cmlidXRlcykuZ3JvdXBzOwp9</value-transformation-procedure>
              </transformation>
            </claim>
            <claim>
              <name>locale</name>
              <description>OpenID Connect locale claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>middle_name</name>
              <description>OpenID Connect middle_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>name</name>
              <description>OpenID Connect name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>nickname</name>
              <description>OpenID Connect nickname claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number</name>
              <description>OpenID Connect phone_number claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number_verified</name>
              <description>OpenID Connect phone_number_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>picture</name>
              <description>OpenID Connect picture claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>preferred_username</name>
              <description>OpenID Connect preferred_username claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>profile</name>
              <description>OpenID Connect profile claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>updated_at</name>
              <description>OpenID Connect updated_at claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>website</name>
              <description>OpenID Connect website claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>zoneinfo</name>
              <description>OpenID Connect zoneinfo claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claims-value-provider>
              <id>account-manager-claims-provider</id>
              <account-manager-claims-provider xmlns="https://curity.se/ns/ext-conf/account-manager-claims-provider">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
              </account-manager-claims-provider>
            </claims-value-provider>
            <claims-value-provider>
              <id>auth-subject-claims-provider</id>
              <authentication-subject-claims-provider xmlns="https://curity.se/ns/ext-conf/authentication-subject-claims-provider"/>
            </claims-value-provider>
            <claims-mappers>
              <claims-mapper>
                <id>default</id>
                <access_token>
                  <claim>groups</claim>
                </access_token>
                <id_token>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </id_token>
                <userinfo>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </userinfo>
              </claims-mapper>
              <default-claims-mapper>default</default-claims-mapper>
            </claims-mappers>
          </claims>
          <openid-connect>
            <expose-metadata>
            </expose-metadata>
          </openid-connect>
          <client-store>
            <config-backed>
              <client>
                <id>xacml-demo</id>
                <secret>$5$.Tugfmc5z1PCWNOZ$HPd5hWY6XkMYdzc1crl4pgv83S.bKl4z6QDjf/I9G61</secret>
                <redirect-uris>https://oauth.tools/callback/code</redirect-uris>
                <redirect-uris>oauth.tools://app/callback/code</redirect-uris>
                <access-token-ttl>6000</access-token-ttl>
                <user-authentication>
                </user-authentication>
                <allowed-origins>https://oauth.tools</allowed-origins>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
              </client>
            </config-backed>
          </client-store>
          <dynamic-client-registration>
            <client-data-source>default-datasource</client-data-source>
            <non-templatized>
              <capabilities>
                <code/>
                <implicit/>
                <resource-owner-password-credentials/>
                <client-credentials/>
              </capabilities>
              <scopes>
                <all/>
              </scopes>
              <authenticators>
                <all/>
              </authenticators>
              <client-authentication-method>
                <secret>
                </secret>
              </client-authentication-method>
              <authenticate-user-by>xacml-demo</authenticate-user-by>
            </non-templatized>
            <client-management>
            </client-management>
          </dynamic-client-registration>
        </authorization-server>
      </settings>
      <endpoints>
        <endpoint>
          <id>token-service-anonymous</id>
          <uri>/oauth/v2/oauth-anonymous</uri>
          <endpoint-kind>oauth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-assisted-token</id>
          <uri>/oauth/v2/oauth-assisted-token</uri>
          <endpoint-kind>oauth-assisted-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-authorize</id>
          <uri>/oauth/v2/oauth-authorize</uri>
          <endpoint-kind>oauth-authorize</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-dynamic-client-registration</id>
          <uri>/token-service/oauth-registration</uri>
          <endpoint-kind>oauth-dynamic-client-registration</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-introspect</id>
          <uri>/oauth/v2/oauth-introspect</uri>
          <endpoint-kind>oauth-introspect</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-revoke</id>
          <uri>/oauth/v2/oauth-revoke</uri>
          <endpoint-kind>oauth-revoke</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-session</id>
          <uri>/oauth/v2/oauth-session</uri>
          <endpoint-kind>oauth-session</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-token</id>
          <uri>/oauth/v2/oauth-token</uri>
          <endpoint-kind>oauth-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-userinfo</id>
          <uri>/oauth/v2/oauth-userinfo</uri>
          <endpoint-kind>oauth-userinfo</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <access-token-as-jwt/>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
    <profile>
      <id>um</id>
      <type xmlns:um="https://curity.se/ns/conf/profile/user-management">um:user-management-service</type>
      <expose-detailed-error-messages/>
      <settings>
        <user-management-service xmlns="https://curity.se/ns/conf/profile/user-management">
          <api-authentication>
            <oauth-service>token-service</oauth-service>
          </api-authentication>
          <authorization-manager>my-xacml-authz-manager</authorization-manager>
          <user-account-data-source>default-datasource</user-account-data-source>
          <devices-data-source>default-datasource</devices-data-source>
          <token-data-source>default-datasource</token-data-source>
          <credential-management>
            <credential-manager>default-credential-manager</credential-manager>
          </credential-management>
        </user-management-service>
      </settings>
      <endpoints>
        <endpoint>
          <id>um-admin</id>
          <uri>/um/admin</uri>
          <endpoint-kind>um-api</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>user-graphql-admin</id>
          <uri>/um/graphql/admin</uri>
          <client-authentication>disallow</client-authentication>
          <endpoint-kind>um-graphql-api</endpoint-kind>
        </endpoint>
      </endpoints>
    </profile>
  </profiles>
  <facilities xmlns="https://curity.se/ns/conf/base">
    <http>
      <client>
        <id>xacml-http-client</id>
      </client>
    </http>
    <data-sources>
      <data-source>
        <id>default-datasource</id>
        <jdbc xmlns="https://curity.se/ns/ext-conf/jdbc">
          <attribute-query>SELECT account_id, username, email, phone, attributes, active, created, updated FROM accounts WHERE accounts.username = :subject</attribute-query>
          <connection-string>data:text/plain;aes,v:S.blBjYTVxTXV4NEpkbkpRWQ==.kp7gZAcxoVvBfMxj7q6IVQ==.JnFusO29sHceWQokWaBUkOre3xCUTSOfGUTQSy8Ftth0VZOZhLSM4gTIAtOF_-pe.B2AQhdH5TRl_-vutsnyORJmfWOYt5HKHvZXYTiToSuA=</connection-string>
          <driver>org.postgresql.Driver</driver>
          <password>data:text/plain;aes,v:S.aU1rN3QyMW1kcmJDRkZOQQ==.SBcS7Q_sDp0UtWrYo5KdNw==.0Tt31UGh8h9YtZbcQjg9rQ==.CS_ZB3O_0J3IWKW7D02jy-Zk7TgQBKDIPOgbe4Sx62g=</password>
          <use-for-audit>true</use-for-audit>
          <username>postgres</username>
        </jdbc>
      </data-source>
    </data-sources>
    <crypto>
      <ssl>
        <server-keystore>
          <id>default-admin-ssl-key</id>
          <keystore>data:application/p12;aes,v:S.V2lhamFzZHhjS251NkFFVQ==.kQlD0PUqbTYECUKL5SIyUw==.PxOdIYTJTDJyo8XU7H0WN1EwQzNmaxrOn2pYkxDwj41o5T-S6fyImRJBiLq0dfTGZvz32nI649dtxR5EEHDzrEBbT6qabd5-y1ehSuepg-Xl2kPUqHFmNcZLAQXIETScHK-qvPM2ZwmA1WP2__4HmxFggIbdfIEF6sSPSSOjkA5mtiZdaouxS5XvoaQAhDfkQgKRutkfHps7F5TqPYxomJJ3WCfwkzgWJKHUqg2FQnq0nwMP_7-5LRTJwdE0DVuLgoEM6P4YLa27XMvjedjQzhkKFGg0mlMORkNFX2zIUKh0ZriVgvDLk21YgvYOgJ4_d9mJKjd2MP-cTUov6k3wPy7P8QEEJ32qORnENdFWO_SsmZWZcMxa7Nf7KcFeYtMh8wFF9NmCykwxKHpNH-Hwyy_kT_zRCJYpAbCbZ3uj9mRWTmDMTDyujTCeo3OfWwbmJ_-LmBdTdqb1NoV7Zec99EMC3rnkO8-6P_rptwxBtgdpdqgKBP14H97bEKIH2UmDVqh6-NgEinEc3Pe1Rz3Uw8IWoQGDPtSdU2J6MZaOE_VoqwcXT9nZtHTokSDnPf0ZYJv_slcpBGjyb8lWC8GO6zGD70jCpSMidbbBqb8826W__Ka6cWObmUgNej85s7I4O0h12gKvyvj9NTSPcezkMzgDFUb-WDOA34TQFXX9Q3-LDwNQ0jim7jGFPXR8QhzpmUYAl2EOaUY296s5Nd97W8yp-xzzzjF4gUFaktoJyBs1soniWjPeyfhrJMo4F6DJ_M3AwNWm8OAkbvVu04f_KUKj7PMSwcpzn3paMchk-myVwLVZF7DZa_bwrpE77x_GccHxDwWWG-7XfgesoPsU7Ht9U5nOzqg9q3dW8Eu_xEMCdV91lKcQbTHEEbHE1fTj8q61ah5a6VN6TmCQyl8ui4Wi_ROK3fLfHnSikPoxIFcg0eQ6v5-ddyeuhS4TXghZuA1x2TeU64kmG3xjW-rKqT7DcrhpH_-lzoXCM0VSvuMn3g6xsue3M0pEzq78dKbPU_yWJaIGZjsDypx5FaDCdG06YVpzPsFTnddCyHYQmN2TbatO22v5AQd9egl_dEfCN9MbmK9LOmx099QfoQ5lhlsacdEmkQcIfbBPxKg7VRguCnGJPvjeOGV6DnUWHdGLVtDO1uP1hswTx_vgXHbxJsSXGoLBtJUdBIZnTtgh0tfdg4JMsl2pe282a0HwMiP7UnUpF5Wv_tPAfBCvfvQxNh7Uc5DEHuKFqFlGlthxayJ58M9_na3tp5Pd9ZnBid53XLlukFMhcXYdsAEu-_akdCNNH_VFvZLJn8XvqJm9OZrT4CIQgmbLeMCwav0gx4oxBXK4dxOJ1ZzusRKc_N9KrmbXWAPGe7-NYYl3FhPtvWxQ6Dgs0sKUiFcpE949u-Dg_QA5J3icf0CVDBhvQYV-JCXgIKZUW5o2HH_KYN2qRMnPsHb4sTdmcx5zcO8yXAmukoXRvqzmd44ng3CUvbWxsCLyPzkcB5N8i4Zwb1KqdTIhBaWFfNTvqDvZ1FLxBLivM-3Oer8ACZzsxTjyo5UJKvRAbM10g5XjxugnoTuKhO58iVwjrLzqJKbdG80oPZIKFzMA7kGysTk33nR0HdN67O9yU94J_1aHNH_PwK9FxzpwHagG3jRdjaL6Y6Pgb1ALcHz1tnF0y2rmM8PVRMvGsQS0-ijP4BaNwtRP9kzUgVQ0oNXFqDru6MguspENA-pw6B8HynFdphK5k1XdNiqjo3IPHbXwP5f6-Z-Dm0-XwC1BfHcx925M_vIaxvTgAEETD4ptGgaMC4My8dx5ECFj8luT9VyTRI3-9lcP-kEFDg8C-yz8ttG_xpqfEMzv7OJvKk9mkn8M4P5Sk7KV4xidT1lF4PuqsWgwuhdVmT_KZH-kDqIU3dAAtdmaKJ7HgSf-I6MDjc4Awa4GS2ce4MsQDDxJfZKkcYnLx2F67KF_lC9nw5GxTlPZhhGeJ6rGFBHfDuU-Wt8pglbI3q1KBoLbnpcY9dgopBtmD-Iyz0LBpVjEu2aVFNlL_aRzGuVN-kIz8GdE2Dxz9M_parb1Yyjxuw3wD9gWZKWkGrzPY3A2Ex4Zz0YktLk6ym2_5KBi8Y7IKSzVijLkgEgYZ_h9F-moXNAwAUun06PbiBo4VeeHIvGQd2bmFzdqF5lBEkI6MezJ8CICUMXAY7bv3Ga3XRorOLy1pE6bo5CWMhEi44x5dMhG3gyovc-ompDJS_-bCynp0Rr1lhATtFTf7GOLZbNjeQJczVURBtDxoyRrgibuHYfSFfAweFRztKK014AJkP2IsrJEo4ZYp4yhVinPHRH8c_gqAJBG0nO6FaLxePnea9b4rH98fGW_J7Z2dmTsSFce5JJjs_6cPIj9xCKKccUa2aOppxbZdhiO7dhnL4JzdEryDdNp5m4tYP7o8Ty-_GKxbZz_yZYbNckgDNsr1LfKOGDVBHVA7WUIVQ7-kxXIUvQMbDe9TRQBVlzd9F1ABtwKQKabkeRvBX1hkThuzfa81_cEW7Co-EwetKue3zSgnGomN_Um-qVc1WooJ-bn3A9mo8jTm_fuZRSbpRrokrOTrJOwYtQunIU6gT74Fad86P9M4c6V_aCXATVNgDr1qbn_ssGxW-MKemkkXL9D1h1WFKDi8yzPJL0Ic9sc3KJppbLdEo9dyoUY9q_PBJJ-04qJWPshsH1252ebYZGc4XVLGR7_-vvibZk34olta7h4v3mO3r1XPHUWJmgL4c3C-m_EXfDn4bkgoHmRpOwqoc2PP8HFqlAARFuZQ0I4eXZe4IUuovtUOHgPSuf0iEJdvZw8imkUPnmCTbOiG87u3MDbbzRpTdmjV-FWQgawHyBZ3XdDiTkYI1FCm0euSPO2FkhMKR7u5oZcBkxyZiV-_CkshgPRTqarELIH326WIH9wKIuqsLg35jGqu8hMVBYDTUWrl7FAW93MCsqWOcxrkssSVAySzjukcr8-qdDFVEvG7kiCND1VPRBFqLocY2gI51VXYcjZy7MF7oJdo7_G6UG1_R1Bw376P9WKXICj0GaRHRsjeiVaCrGfR98yPANbed-PTD_wD6tBwC-LAWva8g82gUUEkLZzMvUZGG45La0tIsq-KI1qJXJgDPqbTUCE_nZFKckdm9YVF67okmAW92R9uk9sFi3yxCsQU-c50eZ68Z8Z775GSxE5Xl0ottkwyKRt21_zzDScaK5ymiL2utG6FP2TpWwLhuNaTsTYHCIT6qbR5h9MR-pjlzWNlPDpeT12syzCP5Ve2THrowNXsqop54DALXLRMKCMiMC4M8e-zp1WbYzXGhxt68scNXGfXOTwQLEqLjA3orgDG0f703UdiKGKUuyjvSTXnYtbm8EYs5GmtpAfcN39Txhbelm6djIlr6iIjCMp19Q3ssqYTg0_3pImd6yw4VMPdd5mVzpkIaopRAh3ZqmSHIUy-bghr71zhR_-EQgnbtUMt_Uez0SZ7yKqq1jSP4PfW21ajOt2JHiAxhe-LOgbImjtil4EaJP1nEOEUBQs2SglADbRBTQylR0izgzGopr0U5AU1D846yxDcZgGcWHNbdJShd-lE598SwRpk7p54roTyFjG68UEHg==.QbNuQ9gsYaGwODD0o9aorr029-GaGWGn22GJgtM0U7g=</keystore>
        </server-keystore>
      </ssl>
      <signing-keys>
        <signing-key>
          <id>default-signing-key</id>
          <keystore>data:application/p12;aes,v:S.SGljc2tpWWdLRTVxdGtSRQ==.OCCNDrJ-GXtgL2XS9lVwBQ==.aeBE1CJDQCilrvpGVZUcXGFYKPpu42_yF580UJLPEVCt7EMguHu1uMM9mmR4m5x9avyv9eIVwMvNcDaCj8DByY0jK6eoyKE0d7qr6V4WWKsQGMbVxVkJaGTR5wAkJ4T3Y8oH6PwJgsxPjNs4CFbmfokJ-pa7bQgZ55zwLkyZ_nUADm7WslcIqa9FJh5BwpWGfcWayKZsQHtvjUh0fQTPi4fPhNGn0wL6v-WSj51Ue9E9Vn4x1DGkT26RH9QaB0x8VVJfJLEsmQzVKOav9MvtVPi3mBDM6EgLgbDb01mrd5B3kLLx8YM8_ePfFvp0tK8aesCvxC3QcXNRWdsI81fGACHq54FqHcfuAPpg_G_Xk5d5Q44dhC5jOtYDdmxcNh5TWT4po5IeOlvEiPI9SMlPchuVqwm2PLceUk6yDmSDdE1DuHs0KzccFOZWBib4ShI59wNSgKCf2lXWZMsJaBIrnm883LX25wXiWl_tiwy5vzitXtM5E0XpkCgtCJyW25dJOQdF8wCXACkwpleYXa5-28GuwKcGxtDVvod1i_FxpdsdJg3bl0oYXpuqawJUH4_20T-r_0tGac5B5aMjUeZE2GLeZJGiHcEKHxrQ-Ad92d0z3QB994ZbD0vU_OrivkeICh1UsVZ3jzJ21y2Je_BmhcG44u6BhbAGAwlI3_vljNAuUGagQg3sKw2YQpRuiLqKxLgqdSmaSIAkpe4B4bUwzJrndVURI4kVsplZQ00QfoCIkKqiUn6kwhIFwm_w41y2pgD46QRTOh4knjo4jO9TPEK2sf9mz1Q9rnF_RqQvH4KRW4LBgJdn1FZTIGL4dvUGrWRxM1hbHOxihwqsyyFraRMWXrfc7PnidDlhDi-kwzrbgwC0lrUrAE5wz5Ns_6nIF9pSjet3CLxE54f1NegvuMhqb5aVoAsfdtO44XPFm785oOY5UYp1EAO2PFIsISZ3e7KgiT5SAM8XgtUUaQWYDIXYINwD6jPiQG9HwaMM8hy6K7O8BPNjJ8RBr9iFeCY6frio6gZc3Ac1L9wK4iDK2oardjK8JQl8MeFxVd3D3mjBbsjPkJUQBNABgdqtV4N1leckvYki8kNyougC_nqR18rPeIErJfz65u7jZkFDO7firzm5-6fb5iF3ZuD-RSNczsEbkCdzZFrQnEhAg39awhPbNUQpB0KhCCf3Ssci04o89IGJcTmKs-qf4A3p5k-0YX8SOJ502j1VnKfZYvOSBaTicszQ6Vwnr4TV2I_qtYGqXjHNIzKieJE2UeX-myejuuzc1eDEUSmjtOwjXj6zexF2IivvDX6QeN2Z_d8bw9LoSduNlzw-EpmvugkTdnkQaFIGc9rTUQjZdsV-IGV_6USc4adQyEFAfo4-fL8U8p_P7B77BtowXsUC80QdtbCzANuW7kYcta_N97f_B4Ze8q-INHd3x0KCwonO3qht0pJodREUUvoKLS8BWaFlWvVXXJDeYA5CL0JOJmBTYSLLmxRVAdBbAc2jBqGX5THIHYkvKJJftgeefrEtJrOyuNNZ9g2aHXXpUl3FVkxoe2ScHmMj1aS4P5KP8fAEHqU3fOJGmg3W24rblJyywxPB7pioxgRt1k4FEXrfqDjv3-SdjEiO4ofbrBJmytS98dKsLzfWpz3kLAkRG0ySixJuhqcsEpbPZT7-pJP1o4TeApM0mNeJpAJ-0dudbqeBd6pgC1dFMeZ89EMjYhD8Xe2fYNgT0e3C0Kr48TtxOxyxhP2sF6aXZ1Q2_Vcj4QOM6KAtyNc0af3bdvK4VxnUmCaJbCGYwX1J8cCMGcqMUmnwV58G2QDUvrdS9eNIhVSSCekrcNS0kfHBLAwYbLFefJhebpdvkKu1kdhK3Kt7TcP27xUgijWhomq6Qm8bW3G2WuVBxzXCE9dDmHNS1BhMZLwXik2c_eUJb2EzNcmeLzZEbrfEQOEuWw3MqDemtmleBomIQ3JMVzxXoHw-DZObMDHhS5p1XMbno01Uz4aw4Ps5TJDrsUts0VLGw90TOZxqTGATaZnrtIe5TO30qiba2iLGhw5nv46hOZd544_0MUYwNDqK5FKesHyXkX6Dwa8xA3XrT8ZrZnPyzE_Ib9qMbYcIQgYnZaknIeYbxbrxeH1MsIWcn-cb0colAP_6eB_F-IaAMOSKyABnY5rIuk17B3PMJhp1nw8n8PDrKg6CfhFITyTYZR8N20767N9ZEDy8xvi16xLhPwSdVthQLUpsPx-9oNKTt0alQ7f4glb-GBqYrkVvZKnXymeUTnZGzKyDqog5hZSSLeN1o5cS-23u2a63BD6SJn-trPK2NBQcoNiZjb5-e8IxXFf7qSTQt9FbCumrwSjazoY10nYovDS6wDHSO9zUuSKa8HfxOw93U03-QgiHP8OfHWLEYmqc8bWE2LLZI4RQpx90NLsDuHvFwqWoCV1i82PwMcX2NKL8qRnXiD_EqrG1ldZxJIXfSGMYAL6IVDz3nXcL4-6rIRaXGsgA8WrBBDLDqXQM36dCBEcUYPZh45SKQ9GACJKmhsisy7FujqWMGPEnD_vtkKZR0r29P9Ld-NisiDL2iUf3U2-5PkgdOuP4JR8Yx-1F74T9vS_QXplggByrLWh2CTRZEBa5yWwJ7MPu-_ChWMOhqWacBEDoLAQqKRgp9b8H0weNL3xWh8LOCzdO3eBac-5QOtGuJj1gLe5R8vPpjiOmdE-EhrX1SJMep6I8QjGCbZFNpGB7bh-zzW0Bir_waAkqv_KxmpxYA_9V_na315d0LSmLjem2LRCOzVZD8T8rZaS4luk78yZFRwPKCx-R_jfjNRcLUXWdMZTaekltRLsC8XbJrvZv90HKrjNkkvoKIU2eiHFrvjWRQ9XuEZTJyYWkR821TGC1vuU1OBR9qTLuXtTZiPdcq_l0cLhFfErbzhtgJ1b_soGxY4iyUgI9df_lmmQD_GUZIg7TEyKwEncHqnaHT_27yXZLJ7BqrnYgaz6gTBIrnWyXHHyTGE9g1beEKc05ww2fRi-nNfGOnfAVkhNC7p83PCdI0-gafACygoKqGoN7LkQ_RdUjOGhGO_vtlNk2IyWaAzysMavWazIgfvkg54fJWOzUGOYZDd8_t9NvwNGfreqW7NpixUCjxjrlatbBtRPcu9zrw8Vdmi62zOq3ZV8UeWrowsNvWd_EdJ7khL_a9qRMxYzy5hVykcbMNBzDEM1NBwLBAaFCa53VHOogv_GmOGNAEuoXJGjC7miLrGP5LMJ7LYn2PIYeOJfPHwHujrRuGIBophImOFUbhD_a1xUxD-FP82_dlEnj-IeCLzT6cSr8PQZ2oIcr4CTFGDhUFI-q0lURrPaWF9KnhnAZDWBWMWIXXexsz09uDT58cymsHbDq7X3VgQ5femsZaeKOoHGZ9tbsmhFuEFo6gzzw6MKpkAoaEmS88zRyX3uqeaiiRxyh7VBJGfye1dg4CrPgb9wAuYitKUJqDk8yoLAAjgNdGYsJMtlN2cRru73NkVZwpQwIJNYcPbjelb6BLaqoVeUryNmI8XinUXnm1DZ8JXl12W62BiSvIs6j8lP6n5Ri_zJLTLg17uWb_vMYm0TT9KfLeh7NCxYOgbbh0gAA86bnqA==.MZQqSahCq9kgk4eLJBBtJDk8J4hisCK0eFmjclNXNgc=</keystore>
        </signing-key>
      </signing-keys>
      <signature-verification-keys>
        <signature-verification-key>
          <id>default-signature-verification-key</id>
          <keystore>data:application/pem;aes,v:S.S21Wd3doVFQxVU0yeHdSTw==.eZ6iKADt3FU86um6GCoA-A==.wozGjXCb19Oih3bY-ZifUUeb5ZVQBGBf3luBVtTdi3WX1wrFt91zGt-ln5qfPqnr6DpPUH9q22yMm1Vndz2F881Moe3TPTKxd2zFJkAwdHqePl9527AXzWA99sCqLkSrv45lqtl8aqGKUu4o3emZkD1Rc44hYpkRoCw6HBF4LcznyXui8YpzRqXIJQZLibm7cn49hmu-adv_k-WhgRSM4TCRRxhuDZO3ubxXt0hmPmdkRyWtk09zb76XQk6ku7mGcVaG3aPI_uWVdpOSa7OI5HbUjLafkWbxjwdpD5EK1Zml2lED_OGO1Fy-_XUx_C-Vq4fPVAeicO1F-_PlMZ58ktcQ83nhQding-9iD8S-lTkMLaW9JaGXCbzpNvxINe6dbAfml3vhMZAr1ixgNaOSxHAq-v_1kUvjjixibAi0suOhvzcNzXZXMC1g9crpz8jmoYnxSz7zrgmekFrp-Cu3z5LUx3k56-QwjVqXihIW4uRw08o34bxokaNEvLm7CgBITPXTQPSMHHWW6ybgzUKRkTGMFY5HC2IPMsSuPZl22mZHzR_QaTPTH9iVsiqOP7gCpKyE32SYJRJwQhnYt9oEnIR3Is89FkqWxCmkrrSBrMlcU2pmA6g-HkmSQwT_Ew7vvFciDdZihYuwASR7YfVk6vlY5GkaOCBGdNR4fc_S-E4IRYyYzGQllYYFygg29o6sCrTp9VO-t0hsbhf6qIUjVeRm3azZX1ZUzK2OIuiCV8B8x6nfHgQdnqIZq2bBQwgUHn9jQOXt6f5-xt5muxeySKooHi1zGnQj9GrAy3wiIm9dA04ZbCUp2ZZTr-iGy87gGwBYPrKy23FGJMiDzcldWwJ-3qgPIK_DnbovHfYWXj9FkUHHAbZMY9gxdPW3RxsVANY84ZmmGpKppBrJj4coxrufTBwqsm0Sl0hgGbeXjr6MrzB8oXxgxsvqaIBJJIEEfXA2xf2QPvuMg5LWeS4EZzj2lFeJhKdk0kqgSrhgoFvfm-xlQRQxMzJ3Lg6oN-fy-ikjgeuEMbc0Lmhl8UBriwMo4shYd9cMpJPFPMxNbkigsOEvRYb9ribxmnYOKaQ4yNrOepeNa6tn9GkgaSwnJ14mXkyB25l9MvB-wCZAbHGDGccD9B0-J2Z4w2LiIGjPGZyOZtXOiFO1nGKLnYfOQAEGR9UeM1YU-EC1leCRWa9hPhigAyC0kUsDoh8egUBXvhGN4QbGQRw0uZnqoBaIwMBpS1M8bXOB-IeSuqqo7LhDazvt90BnJMnye7BwKilU8zkAqp8v_GBoSnmQ0TEZUjEq2rV9FlR3Une8VtNatyHGA0oq0cSWgI5caoy41ruKNFVeHA4LcmElqMxcDaJV0IsACsbXkGx2PniOqJrmhjksyXQdCW9ting-murttyiiMKiccIYIflV7TgUpVXBbXzl83qGztNz5ofG7h9R0azPOENAo37Wt2mKGB2SlKFcvyJ5MK7NSTnu8vP2TasI8sOIkroV-xu-ooiG7GzZihhronQTBPJ_5tI-xcWVJDwOrGx3fW0XaVsjb7tgl0TieoLg14L528PvHEbE4xzsb_kw0PC0wVGhZu2awie6w3ABIp1Loa1fcRUUDvc1Kb9DNCQ==.u96Up8WU__7k887dYKmXIbnOe4LdZg7UpJaIfV0Ed-o=</keystore>
        </signature-verification-key>
      </signature-verification-keys>
    </crypto>
    <caching-services>
      <default-caching-service>
        <data-source>default-datasource</data-source>
      </default-caching-service>
    </caching-services>
  </facilities>
  <processing xmlns="https://curity.se/ns/conf/base">
    <license-key></license-key>
    <authorization-managers>
      <authorization-manager>
        <id>my-xacml-authz-manager</id>
        <xacml-authorization-manager xmlns="https://curity.se/ns/ext-conf/xacml-authorization-manager">
          <http-client>
            <id>xacml-http-client</id>
          </http-client>
          <pdphost>xacml-pdp</pdphost>
          <pdppath>/services/pdp</pdppath>
          <pdpport>8080</pdpport>
        </xacml-authorization-manager>
      </authorization-manager>
    </authorization-managers>
    <account-managers>
      <account-manager>
        <id>default-account-manager</id>
        <enable-registration>
          <account-verification-method>no-verification</account-verification-method>
        </enable-registration>
        <account-data-source>default-datasource</account-data-source>
      </account-manager>
    </account-managers>
    <credential-managers>
      <credential-manager>
        <id>default-credential-manager</id>
        <Sha2WithSha256>
        </Sha2WithSha256>
        <data-source-backed>
          <data-source-id>default-datasource</data-source-id>
        </data-source-backed>
      </credential-manager>
    </credential-managers>
  </processing>
  <nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm">
    <write-default>permit</write-default>
    <groups>
      <group>
        <name>admin</name>
        <user-name>admin</user-name>
      </group>
    </groups>
    <rule-list>
      <name>admin</name>
      <group>admin</group>
      <rule>
        <name>any-access</name>
        <action>permit</action>
      </rule>
    </rule-list>
    <rule-list>
      <name>any-group</name>
      <group>*</group>
      <rule>
        <name>tailf-aaa-authentication</name>
        <module-name>tailf-aaa</module-name>
        <path>/aaa/authentication/users/user[name='$USER']</path>
        <access-operations>read update</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-aaa-user</name>
        <module-name>tailf-aaa</module-name>
        <path>/user[name='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-webui-user</name>
        <module-name>tailf-webui</module-name>
        <path>/webui/data-stores/user-profile[username='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
    </rule-list>
  </nacm>
  <aaa xmlns="http://tail-f.com/ns/aaa/1.1">
    <authentication>
      <users>
        <user>
          <name>admin</name>
          <uid>0</uid>
          <gid>0</gid>
          <password>$5$iP3vJpIj$c.ZEStVuRenQvI.5P9DpBV9fNBs2E9ckBAhZ37Lsvh3</password>
          <ssh_keydir>/Users/iggbom/curity/idsvr-7.3.1-xacml/idsvr/home/admin/.ssh</ssh_keydir>
          <homedir>/Users/iggbom/curity/idsvr-7.3.1-xacml/idsvr/home/admin</homedir>
        </user>
      </users>
    </authentication>
    <ios>
      <level>
        <nr>0</nr>
        <prompt>\h> </prompt>
      </level>
      <level>
        <nr>15</nr>
        <prompt>\h# </prompt>
      </level>
      <privilege>
        <mode>exec</mode>
        <level>
          <nr>0</nr>
          <command>
            <name>action</name>
          </command>
          <command>
            <name>autowizard</name>
          </command>
          <command>
            <name>enable</name>
          </command>
          <command>
            <name>exit</name>
          </command>
          <command>
            <name>help</name>
          </command>
          <command>
            <name>startup</name>
          </command>
        </level>
        <level>
          <nr>15</nr>
          <command>
            <name>configure</name>
          </command>
        </level>
      </privilege>
    </ios>
  </aaa>
</config>