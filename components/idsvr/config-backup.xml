<config xmlns="http://tail-f.com/ns/config/1.0">
  <environments xmlns="https://curity.se/ns/conf/base">
    <environment>
      <admin-service>
        <http>
          <ssl-server-keystore>default-admin-ssl-key</ssl-server-keystore>
          <web-ui>
          </web-ui>
          <restconf>
          </restconf>
        </http>
      </admin-service>
      <services>
        <zones>
          <default-zone>
            <symmetric-key>data:text/plain;aes,v:S.dnhYaTVEY291UmRUWXdVMA==.ZOb1ye-d10YnbdA5vJJ3WQ==.9dczHIf2SBjpADKhHmPDD9gxAPk7ptt9ZBG2GYvspOGJhDxxWOz3eiY7BcfKI-DqAke0TAHS8tU_Nw4zuo1b2MZBibgH13Ad8mi8nRhiHTA=.DgIpBMInFAlXsQCihE4ACfpkGU10fK9THTU7NgPX9dg=</symmetric-key>
          </default-zone>
        </zones>
        <service-role>
          <id>default</id>
          <ssl-server-keystore>default-admin-ssl-key</ssl-server-keystore>
          <endpoints>authentication-service-anonymous</endpoints>
          <endpoints>authentication-service-authentication</endpoints>
          <endpoints>authentication-service-registration</endpoints>
          <endpoints>token-service-anonymous</endpoints>
          <endpoints>token-service-assisted-token</endpoints>
          <endpoints>token-service-authorize</endpoints>
          <endpoints>token-service-dynamic-client-registration</endpoints>
          <endpoints>token-service-introspect</endpoints>
          <endpoints>token-service-revoke</endpoints>
          <endpoints>token-service-session</endpoints>
          <endpoints>token-service-token</endpoints>
          <endpoints>token-service-userinfo</endpoints>
          <endpoints>um-admin</endpoints>
          <endpoints>user-graphql-admin</endpoints>
        </service-role>
      </services>
    </environment>
  </environments>
  <profiles xmlns="https://curity.se/ns/conf/base">
    <profile>
      <id>authentication-service</id>
      <type xmlns:auth="https://curity.se/ns/conf/profile/authentication">auth:authentication-service</type>
      <settings>
        <authentication-service xmlns="https://curity.se/ns/conf/profile/authentication">
          <authentication-actions>
            <authentication-action>
              <id>dbug</id>
              <debug-attribute xmlns="https://curity.se/ns/ext-conf/debug-attribute"/>
            </authentication-action>
            <authentication-action>
              <id>get-user-attributes</id>
              <data-source-transformer xmlns="https://curity.se/ns/ext-conf/data-source-transformer">
                <attribute-data-source>
                  <data-source>default-datasource</data-source>
                </attribute-data-source>
              </data-source-transformer>
            </authentication-action>
          </authentication-actions>
          <authenticators>
            <authenticator>
              <id>username-password</id>
              <authentication-context-class-reference>iggbom</authentication-context-class-reference>
              <authentication-actions>
                <login>get-user-attributes</login>
              </authentication-actions>
              <html-form xmlns="https://curity.se/ns/conf/authenticators/html-form">
                <account-manager>default-account-manager</account-manager>
                <credential-manager>default-credential-manager</credential-manager>
              </html-form>
            </authenticator>
          </authenticators>
          <protocols>
            <protocol>
              <id>default-simple-protocol</id>
              <simple-api/>
            </protocol>
          </protocols>
        </authentication-service>
      </settings>
      <endpoints>
        <endpoint>
          <id>authentication-service-anonymous</id>
          <uri>/authn/anonymous</uri>
          <endpoint-kind>auth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-authentication</id>
          <uri>/authn/authentication</uri>
          <endpoint-kind>auth-authentication</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-registration</id>
          <uri>/authn/registration</uri>
          <endpoint-kind>auth-registration</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
    <profile>
      <id>token-service</id>
      <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
      <settings>
        <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
          <authorization-manager>my-xacml-authz-manager</authorization-manager>
          <authentication-service>
            <authentication-profile>authentication-service</authentication-profile>
          </authentication-service>
          <client-capabilities>
            <code>
            </code>
            <implicit/>
            <resource-owner-password-credentials>
              <credential-manager>default-credential-manager</credential-manager>
            </resource-owner-password-credentials>
            <client-credentials/>
            <introspection/>
            <token-exchange/>
          </client-capabilities>
          <scopes>
            <scope>
              <id>address</id>
              <description>OpenId Connect address scope</description>
              <claims>address</claims>
            </scope>
            <scope>
              <id>email</id>
              <description>OpenId Connect email scope</description>
              <claims>email</claims>
              <claims>email_verified</claims>
            </scope>
            <scope>
              <id>openid</id>
              <description>Standard OpenID Connect scope</description>
            </scope>
            <scope>
              <id>phone</id>
              <description>OpenId Connect phone scope</description>
              <claims>phone_number</claims>
              <claims>phone_number_verified</claims>
            </scope>
            <scope>
              <id>profile</id>
              <description>OpenId Connect profile scope</description>
              <claims>birthdate</claims>
              <claims>family_name</claims>
              <claims>gender</claims>
              <claims>given_name</claims>
              <claims>locale</claims>
              <claims>middle_name</claims>
              <claims>name</claims>
              <claims>nickname</claims>
              <claims>picture</claims>
              <claims>preferred_username</claims>
              <claims>profile</claims>
              <claims>updated_at</claims>
              <claims>website</claims>
              <claims>zoneinfo</claims>
            </scope>
            <default-scope-claim>group</default-scope-claim>
          </scopes>
          <claims>
            <claim>
              <name>address</name>
              <description>OpenID Connect address claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>birthdate</name>
              <description>OpenID Connect birthdate claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email</name>
              <description>OpenID Connect email claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email_verified</name>
              <description>OpenID Connect email_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>family_name</name>
              <description>OpenID Connect family_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>gender</name>
              <description>OpenID Connect gender claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>given_name</name>
              <description>OpenID Connect given_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>group</name>
              <value-provided-by>auth-subject-claims-provider</value-provided-by>
              <transformation>
                <input-attribute-names>attributes</input-attribute-names>
                <value-transformation-procedure>ZnVuY3Rpb24gdHJhbnNmb3JtKGF0dHJpYnV0ZXMpIHsKICAgIHJldHVybiBKU09OLnBhcnNlKGF0dHJpYnV0ZXMuYXR0cmlidXRlcykuZ3JvdXA7Cn0=</value-transformation-procedure>
              </transformation>
            </claim>
            <claim>
              <name>locale</name>
              <description>OpenID Connect locale claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>middle_name</name>
              <description>OpenID Connect middle_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>name</name>
              <description>OpenID Connect name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>nickname</name>
              <description>OpenID Connect nickname claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number</name>
              <description>OpenID Connect phone_number claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number_verified</name>
              <description>OpenID Connect phone_number_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>picture</name>
              <description>OpenID Connect picture claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>preferred_username</name>
              <description>OpenID Connect preferred_username claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>profile</name>
              <description>OpenID Connect profile claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>updated_at</name>
              <description>OpenID Connect updated_at claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>website</name>
              <description>OpenID Connect website claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>zoneinfo</name>
              <description>OpenID Connect zoneinfo claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claims-value-provider>
              <id>account-manager-claims-provider</id>
              <account-manager-claims-provider xmlns="https://curity.se/ns/ext-conf/account-manager-claims-provider">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
              </account-manager-claims-provider>
            </claims-value-provider>
            <claims-value-provider>
              <id>auth-subject-claims-provider</id>
              <authentication-subject-claims-provider xmlns="https://curity.se/ns/ext-conf/authentication-subject-claims-provider"/>
            </claims-value-provider>
            <claims-mappers>
              <claims-mapper>
                <id>default</id>
                <access_token>
                  <claim>group</claim>
                </access_token>
                <id_token>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </id_token>
                <userinfo>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </userinfo>
              </claims-mapper>
              <default-claims-mapper>default</default-claims-mapper>
            </claims-mappers>
          </claims>
          <openid-connect>
            <expose-metadata>
            </expose-metadata>
          </openid-connect>
          <client-store>
            <config-backed>
              <client>
                <id>xacml-demo</id>
                <secret>$5$.Tugfmc5z1PCWNOZ$HPd5hWY6XkMYdzc1crl4pgv83S.bKl4z6QDjf/I9G61</secret>
                <redirect-uris>https://oauth.tools/callback/code</redirect-uris>
                <redirect-uris>oauth.tools://app/callback/code</redirect-uris>
                <access-token-ttl>6000</access-token-ttl>
                <user-authentication>
                </user-authentication>
                <allowed-origins>https://oauth.tools</allowed-origins>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
              </client>
            </config-backed>
          </client-store>
          <dynamic-client-registration>
            <client-data-source>default-datasource</client-data-source>
            <non-templatized>
              <capabilities>
                <code/>
                <implicit/>
                <resource-owner-password-credentials/>
                <client-credentials/>
              </capabilities>
              <scopes>
                <all/>
              </scopes>
              <authenticators>
                <all/>
              </authenticators>
              <client-authentication-method>
                <secret>
                </secret>
              </client-authentication-method>
              <authenticate-user-by>xacml-demo</authenticate-user-by>
            </non-templatized>
            <client-management>
            </client-management>
          </dynamic-client-registration>
        </authorization-server>
      </settings>
      <endpoints>
        <endpoint>
          <id>token-service-anonymous</id>
          <uri>/oauth/v2/oauth-anonymous</uri>
          <endpoint-kind>oauth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-assisted-token</id>
          <uri>/oauth/v2/oauth-assisted-token</uri>
          <endpoint-kind>oauth-assisted-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-authorize</id>
          <uri>/oauth/v2/oauth-authorize</uri>
          <endpoint-kind>oauth-authorize</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-dynamic-client-registration</id>
          <uri>/token-service/oauth-registration</uri>
          <endpoint-kind>oauth-dynamic-client-registration</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-introspect</id>
          <uri>/oauth/v2/oauth-introspect</uri>
          <endpoint-kind>oauth-introspect</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-revoke</id>
          <uri>/oauth/v2/oauth-revoke</uri>
          <endpoint-kind>oauth-revoke</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-session</id>
          <uri>/oauth/v2/oauth-session</uri>
          <endpoint-kind>oauth-session</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-token</id>
          <uri>/oauth/v2/oauth-token</uri>
          <endpoint-kind>oauth-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-userinfo</id>
          <uri>/oauth/v2/oauth-userinfo</uri>
          <endpoint-kind>oauth-userinfo</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <access-token-as-jwt/>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
    <profile>
      <id>um</id>
      <type xmlns:um="https://curity.se/ns/conf/profile/user-management">um:user-management-service</type>
      <expose-detailed-error-messages/>
      <settings>
        <user-management-service xmlns="https://curity.se/ns/conf/profile/user-management">
          <api-authentication>
            <oauth-service>token-service</oauth-service>
          </api-authentication>
          <authorization-manager>my-xacml-authz-manager</authorization-manager>
          <user-account-data-source>default-datasource</user-account-data-source>
          <devices-data-source>default-datasource</devices-data-source>
          <token-data-source>default-datasource</token-data-source>
          <credential-management>
            <credential-manager>default-credential-manager</credential-manager>
          </credential-management>
          <graphql-schema>
            <additional-account-attribute>
              <name>group</name>
              <type>String</type>
            </additional-account-attribute>
          </graphql-schema>
        </user-management-service>
      </settings>
      <endpoints>
        <endpoint>
          <id>um-admin</id>
          <uri>/um/admin</uri>
          <endpoint-kind>um-api</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>user-graphql-admin</id>
          <uri>/um/graphql/admin</uri>
          <client-authentication>disallow</client-authentication>
          <endpoint-kind>um-graphql-api</endpoint-kind>
        </endpoint>
      </endpoints>
    </profile>
  </profiles>
  <facilities xmlns="https://curity.se/ns/conf/base">
    <http>
      <client>
        <id>xacml-http-client</id>
      </client>
    </http>
    <data-sources>
      <data-source>
        <id>default-datasource</id>
        <jdbc xmlns="https://curity.se/ns/ext-conf/jdbc">
          <attribute-query>SELECT account_id, username, email, phone, attributes, active, created, updated FROM accounts WHERE accounts.username = :subject</attribute-query>
          <connection-string>data:text/plain;aes,v:S.OGV5aDZrSzl4dWUyZ3VBaQ==.DZF4SifUuIDIngmWzaXUhw==.0tQl29K-xb6et_WSMf8JV9tftl35VQpobc1ahjvoy7NJ2GN6J0K8LSdk-UvXpVxr.os2t40kIRANqg1GD-2OBtAXHFL9zOBorw9Cs1V8_0dQ=</connection-string>
          <driver>org.postgresql.Driver</driver>
          <password>data:text/plain;aes,v:S.b3d6R3MyY28xTmRhRGdidw==.wXDP2CZ5OzeVvX1HY18zlA==.AWNInKgM8BI33rhbOUpuzQ==.83ioBMCn7HYSi1pqyhOgkEUgfhulJby0pbp-ic4co-Y=</password>
          <use-for-audit>true</use-for-audit>
          <username>postgres</username>
        </jdbc>
      </data-source>
    </data-sources>
    <crypto>
      <ssl>
        <server-keystore>
          <id>default-admin-ssl-key</id>
          <keystore>data:application/p12;aes,v:S.bEYyR3FyMzZKbEhac0FWeQ==.4DMhzZnDZh3jwS2cu4jr4A==.YdHmIjNcppEnawYXK-R3sfFf4Dh3nX3Ck1k-_52v7EoPcoZOJ5XKy9h1kVCvBc150DHmL9XV0XmBPh3VOWWeT9yHQerurlVdiHG1oCm4eyIKQW8ON_oN2QSZJ4RQnjbE9VRKqQ24cE8wr1FWeYNIbJ2pFh_gHxNHc4lPLlsSC1RWBqrxNtfo0qp2NMT2BxnxdnChVZvEZ76zTcAftfCKuAFnnM25ePn9bMv8SRjzzBI8_LV63zAwWUIg7eVD1nqEcm7auNqJdnuoFX18MuRoRbkFioASJeJ-Lpo1EHpNIHriglzYdQVrV-Ik7jUMuVQ2RlYH66F83yN5MLgFFnUgMel0GoigQtp7yPFGo0z8KU8l7L_h6yTz3KBpKrrXR9dqPg9auCXohtUVBFGgnSTyNob782uGowqIQHqRJdnfXjHBHEaSnQj2mSiYjnq08TU97dqpthMW8Kb8KYp2JO3WX3KF4IUpI4FxbhbceP4ZdwkDH6jh4zDfDnciNi4pZTnvKUAA9e7kHKaJc6upAxcu2JjT-2eDvlTqg-ElUFp5wriKMGYxB41YkJkCRIexhxJQNflNfAZf0G5hdEsdCiPHAxUXIHzRJYiod0c-1yjhfT22dtATmrLxjgtH-JdAzkDeFBaUH2y1luilLiKOlUkqDi-zjytV2FSfC28p0T-gmvjtiRmk6MDro5ph0axa8op3WthCE-Kr6eX9rnKYYl7uNIOVdUDY8bUXDWT3Z923sFpmqTeNAQN1CBOp3EjqmKjRzfMs7jgbpD_9Dxp5P0xmAhvnmjXcSr1WEckwgbkO3bxt1n9E12X5RCuVo8AqYaxTcGbDUHg14LkwKnX11hNLwhMcKXk0aAwE7NPWrjMRLRVrKkDJfVM5BRtb74x2TvE0U5_Fu8Kkuv1OkgMVXko7OFVcJp_LgRKbu9mZVs5fvl425vu1V4iqk_57Aveq_ArfGG__k3Kg6a6DQrfwfixM7t-_aoNZ3SEIB9hiMq0oOjMSQ98yCeMSIvxbv11Cfbv06o8LZ-6B6xa5ZJ0TNbpYhcB1qBiB-wmiIiHitVrnhgRKYJ7WXyF1N2Tu5ROllVFkRdN581L3Ff4EKCdfz-eDPeO0-0l4U_R8p9BKnsMXLMWW7SvHDQK0pAxg44tmgdjBUQEKAiUp_BCgKw02gzDJIIAKY0pe3PJ0uvA4b0ac5ia-vbfzcCYaSIxcIoT0k0r530lkI62Gf93m_KHSyF_KaskaYlOLEvRdpCj1YRcYWp20wcemiFFRPJ05_hXDB7vbpE4O8u5eKdWreHPEGXspR4m93V9HAzfMnECPwmI4yGHGhHWk_Xn1VOnuOZEk_g1x4HuSBjs--otipdE2zLyH6Ek4elMkzWzEEcSXXEAeUC1z3UJQcmcf0Spg_RJu7PMp6MDfsOv6TaY4Pz6cixcHiNRjyY-mx6hzcgihwe5Keg5HFgtrC--k_-N3rLA7yxUkJvMvRoPsnpdzXlg_5Knm1nPgCdR6e_BQvDexXyHASP8BOGtD_I2-9YntJAiVIq-z-CRlKrOEpRq_TJHK4QCRHDD47ELozgHcq7Av6T1J3QvrMHfEZTBWlXhYr0FUHiuCMbcDWyS1HHTp6j0ava_4N0D6myQLJSXfZhHQFlYll3dfaM8Bbh8r8F289WatLRvME7XKOmKpIYDKAP0pvqnVqjBqTr6EYOssf9x0kkOlhQI9UzSW4FpgaCAYnffUN9GPrf79E16Ro4SQs6rTnRg4O89cctP_QGeYpWLfUHLHhMPILcWREnFY-uUP2kLRVXodRBkSm2hP9OCD8WrDyGq2VCnDbM_jBpHsz0qZ3zCjhT5mb65KfRVxz_W1wKf3o5bYzoZ7lrS6tN_LsPaKccLdqpcvov7sCf8fSfcq7Edn9DiQOH4Tyzzfw-RSQhi7UjCxhtrkcPw3rLTzy_HMIIzcdavq3xTa9Fh36Q3GPx3k3RU_3G-uXBRYSRm2wD_ciAm45MW-N4r0Gdwu6tcbOyXvkLif6cmYKdA8UpSUOixeyGPxNOF3XawBqrUaBe7AmKKAhJp1XERPRdLiYfZ3SI_wBAqIR5Np0peg6eLhNzmJoaorYNyE52iBL1WnbIIy4U5g1_dslpeX2DPGRJCqCzoYIsHEp9Ykr0ADPn7Pebk8scMVHVMMduiUUyZMEE_q7ZJPBocomSkGzdWZ8brg7Ss9MfWGg5auJGoQuglq_cGXhXgiPKMM5xmnEgvbKig2Q3nFJ7Fof1k9iBXO41MK8P8d5e1tjbLw03TJawdfaO-zVYMHJrk9I6PQjOGQV7eBG0loEDcrCq5zoRYD9k6ABsmTnMWKgz3HzQ5ISlbjKegk4GxdojnDkejmDsHvhCyTC01EU1PbqPAgnnpNIY-8fVKvrmv3MiWcYEqpiT9xoijsfYS35aIpp4wmtIWA1eQ2Yh3yvlwxUNQdQNgrJazM4RMghrFrv5nk2p1kZotyUqDIJXgNTTSZlRGobZJ3iGhHY89KJqopl3R-MXMqSeZ1eU3CJhlBxmoDuz5r364I-s7k_RhKIIXCPX1UZ8vvHsGhrNLgDkhLUSzG063XepleXszg_wuKo0uFlY5TvckWJtGwVah9QkXzWrdHFHsaIUSX-KYtYtUM56szJRp05YEEOjPfhrcdBdlWf0dzVs0nJtqxKoWOxLSQjIGRPox_GeUe5DQOugEW3DLx35ybJR-rFRnEMuEqQQLyXAF9yBC_c65Xv7T6SWXIqeXIKbEFnda-q9L3JyIlUYQx6pkMLfBbUsavezjkksmuY77Nnirror-VVftBI5DpW683r8n-8tT9y4DhnGJewwP6wRs6Ohawk2TXAgcBwbrc8sv-SS-6TxSrDz-z61OVtGkRYAZCIq_XObb1FpySz0OghZ9h12svW5D5kijs4jHFhdXkS5ECgfwQKssdTyCdWqiqXeH9kpr2-05VF1Q_YFHSxACd6bvfQlSv-A0Ilt65S7mjgonP0_2j2eW_NUp0Wa4bIFGRoIZj6JWQ5ncwbkkafVRfS96KTVSlXZZZv7QKv9sxMvkzey9IahCO9l8Ii7D42tmTyU6DkCOhJmGuhBAMU6s5bD9I2oB0lg5KV8Rz_b-bPIwM20VDoA0yKQKByZezknssSJtLebv3AIYKKEYAQIoyepP2rgIoVuBr2zp0QEwILBghDLxLKj3JLJWbY9PL7mNVDaMPFvItzcAsW8oRbU-Y3wSFtWPEB4V21nbW0fGp5eabZojjdzngh57kKsBlzSlQGbR5AbcIMDj50lReJLcKz7HrugFs7tdL1TSlIIr66sqaceXyIsiaXq0OS4iwY-IbRY_jU0u38bus_y5maeBGjky3peDKIx7LX9216ADUq7q3F8lN0KpfbET2TbbYRo4VOccACEUuhfDCWRya-68-478nOurII4H-_2JdY2V6OWY-vMi22DFpAVe0xujKg3jHi3p_A9miMHas4w7hv7PP00KcA1rwsJjYP4dgKRfVQsZguxMD58Ec1rBIQB7Cj5fIQhOPzgvkx7x-4dYHmFaMOmfEJVW2rXl3WPz1P-hyF2pKFGvJepJfaUVehgEe8c2ExUSyFRo5-0LL_BYaOx3yRPBcatZufA==.SGD89qiNisYjdM9LluL_-2wuPYwL7gnzGKBLAPUjo4o=</keystore>
        </server-keystore>
      </ssl>
      <signing-keys>
        <signing-key>
          <id>default-signing-key</id>
          <keystore>data:application/p12;aes,v:S.UzI2VlZ0NVlLWlV3TUhlaw==.SsIENTIlRkk_VIymcpcYUg==.fWv8N5cOe8RrQxdWrELxqigGtIObVKpGziJVnjDsdNiW3dOoX8uDVMtUNXo2qM6RXTjzcq3r9ZsXLfXtSMBVGp8jmkrmv-m9x8YULuwXzmgrCGguvf0jJGRVor3-8P_mx_GaLw3HPjElnRSRWOWRvFJCwQhNz-81j-Se_MhtSJmHdhKBGifb3vbuAFC8EdBEsWgPb5xHtJkzOixSe34N4O4ldaXio6CjpPTNIkl8GYeE1x7X2MqeYnIuVr4Cd46fatOpeByAUY4sbFui-SS2yKp9DpGZAxIzlHYZAsdwNl-P9u4I2K_PElKhGelQCDWnGiVaQ92VbxYErIILtqGl_yMJTKAQtBnJB-Q6aEEusR8hfcwEiKIkwBcP1kLZkTAzW29lOkHhiw1c8z7aW-6hDm0NmZW-E7A9DsqsJduHh-UEamw3l9rXb0bANrOUV0Z-gYq0yNRBSuTx1Bc7pFf44roDUEii5AByd9XoPEe-tUzUGBsJGUQdmYYCVTkf1I9W8fqiqlKkJpeEfG4gC5slVjE9ZIT9Wnm3qJso_a32_5Y1RUbJm9y350TeO54mErwSH4_HlyuD7wQIE7McdumlJPHfKmLo8ToRA8P3QJ03aw-lwWCJStihDuRyWHnCVz803HIM4ljX97kaPe_RXqHmmkIvEhk7O3lJrJ6t9P3Djpc9kQmn9oLWCW6WopidMXk-GQN7-N0a7x9WRqblV99cQQeLr7jfcIJO1QqLfGLgeIv30QwaX513f84oSRqlVViXd8rgfHlkdRmAO2ZS0istDb9SdakZ4NN1x8CWUrsUvjwN0guytrFFVKHZmOjnZsLgYBq0RqbXcx1B0cMShV4xQyIyPFcJbdNQUvkNb5WRnXcM2GAlCOJi5UzyaQtSZ0EH4qGSU1C1ksUdXRn7v9yoxnXcN20Vw6Y2qVupMD_WIm_xPELMBPaHc1bBaZQs66Pn8YNXiiDiVd8EFSJHLHzqSgP-vrVbnkd4bvuzjNBEBuJkB7HatAdNMDY_jN-Pwe_zUPrsOjctFws-VVejfY6TsQFCBEO5xNjYFLlw8czrHdL9ZOcCkD5UpTE9GB9e8aT7v8FmiW-ixKx-M2ojsPqWdb45zyjSqVBb4xzLO-2GeO4ogrfRQzuog9vlm001_EE9Hja0hVShEwrP2sH_eHRVdCsC4NIuYhF1YyCuqydz3gY1sCoUBSoNAq1is4c0JnhXcqGO6F67ToIB1ovM0KnwoThOHtWP9aXfD7iFfmverJBCcGpBCPpLTZ1Y02V6vmxI5VBxf31e9Ho-e2xKBm3UlmROZYyrAOgsCTw04CrEqEk8vWnlpXYoNCPDLlTpKAmukBzCMVxzCfaQmsruXbLT6tdvd2gVS4WwVaAGn4o2orHfXyvIGnQ419lQrQW7eiqjXqRFQlIeNhjw080E6nhN4GUqbEpnbVx5AKPfJjPgv5gyjTN8khg0KrHLa7X-u_jbPnxJz0kaS7Zki4bvgcQqSd58pCZH3SrC_9VvkRkV9ExlEJBVD7BhDs06ss7e1rJ7k6memzM6Rzod0O5JDpK82wHasRhkdThGo6QUqBvsoxCzi7mowkNOwL8kDPcQSG7CniQgPpTw3d9fAmZ3vaVPAEaZA6Ic_Dap2RScC2cHDdmNr4qAc3bpff7rfE4_2CFb0mtwJ7c-ldyxN-4z25iwODYUuKSXaTEsRlAL-5OF0Uf9fq62Y26bTXKuzc4eBe-s9ms52kG5HIJEIaF04IM6qCZIsSkZf41c3sIOiQOO2dfh3gAGcIhy3zOGsssF9FooAwIZkx6Hn0Eb2HCJH0o_wsCqH7pKwukr-gamvSSSNyCDP3JegIvG02u45j50oAypzTvMPx9oSou18O__RXyIH-H4OtH9JvA3pZp0IWcK4DG0ND5YU69d7ObcHAgkMIPRc9Cfd-pAvXkiB_-bGaKR6_lgtQVMOgNBzjPOVaw1WBOuo2cr3WUHvSuiogOuEucWPHrBOFIVaROSkooyV2tncCoG2D2DzJh3KON288aM6HJBiTvve_Tj97ffJ4Nk-2bO_XpCc33w2VqWg6iLoG4DjBvjlCYWgw6_BXZXjA1mY0yyhBjPkCQKQJ1SrtG6aB4r-4fokOBfP6THCRDN6xmpGgEydpGQIghhxDHsyUCJb5tdpFi-DARSBNhHS90yUFDGbt2Si2OLCAJM28GEaWfuj2jUr1-8RxiZSgBgl-qVVcKTFtF0bOLCB8n9uJtLw2EyxGjzQ3qBdvv0IkCET1Fe6cBTQF4X9dGMDqYSLSs_Ujan7ca1zFYYMUwkYGlsy_4IH366JjKKHwnxRNKrhzb9l5hrpoOcGpRJoYYDFDBW4qtNwIdoo8EvEuFYw2Th_c4I5EGqiT68fulkBxqI8RzJxYBpvwH5I3fwP6VbBHxAUcyw8F4D9iG2e62U2oQLP7RgOFDcjg_kBcVfiQGn3YvvPEXsn1HsN8FqW7SY9UjL5xhngffsRWwMP0lMOzn9MktcKBTUH3DLlbJajhGpQjiRkZC38WoKsGCySLQSa6LuhARLPgmJrrTEMxWN7oKsTinAipqwjP_I1n7WXyoVYAv1oROkwa4O2ciiTIL2ZX8FJg1nvaoWganZpCkKm1QzrV3O23u6D5M-XBa3nox6OouxrBmBHHzmjdixaO8fSOneQwjRW_t47jRd--Cy1LLBv7JXF-jq-bjbNWxLTekXld-ntgXJz4PBRu1QhnkRaKPfbEtwsWjV_IgsN-gKhaRCXQJ8F8EaYTeYYNJmbfzm6ptVUDcjtTZTWudTYh5s6Nn1jKSuGyw1hoaE_6cxEz9enCWHDzu-gG4TxgbLeh-rfq2N6HbSqdabXsrpIqP9ys7Xx9jDeQIpkeeN42TpFlXZmSmx7DepLe7DAcGx7PznIiPn0stV5u5tif5-QdwcujQ0tju9GqYMmC1TIyRLllbyIU8qHSBIfV-T37bwVzLp14CIQMTW_26MPYElBdO5yi0TYshdNMkbozFexyOfR5IfgyrmY7eAAOnPMeRVX5l4Kkz3J8-UkIeQAvJDX5y_cH9YG5Z3HJH_oIJr6075OXu_l4i67F88X5oPZ66938AlS04aoWhKm9XKYrGDd-0NEcv9EUCFP_VoUAVCtNZQXZ7d2FzD2l9fkviXPE1ObcLQ718OcxLsiDuyjCEfbLQg_ZjwtIbdxyYlKyip4xdojHBCrK12KFniW_r1v6eLMWnvEZcfjKHGqYihoOPbKScu5nYlpsGzIIhbXVNNQyQfyI0o-a6YxDOCs9AeBn-ki9NsNiam30KIGqRyK7jqmW_9EECtF0BzFaez5nbn9d20nrJWAdDgJnKlYD1_icRu4vGe465cSaL_fFzgVVfhc6JrK93-D9hR7qUtRQ6IfxGoEMgYChvIq6rrIkTL3WjYu4y3KjM3a2K9n-ZMoUgI7oBFbFJMN4vnRXdFA_11lKHYlLL83q703JMx7Ck1Yb0rHRxN7gmB2fqnYUgpSJiUgOIgBiRgTdNc1MSnO-onNsD5QxmTdQ44LqUSfDkTVumI4CY09QkOTWrK0yLCXJ1Yt1TA92YKISCSiBLZKrxlvZsRbDrTawYDo0LLu9EkJ3I--DFO5nlngA==.qAh2Scu9IYReWmB8pRaDujxFRNTsked2IAbdPYfk45g=</keystore>
        </signing-key>
      </signing-keys>
      <signature-verification-keys>
        <signature-verification-key>
          <id>default-signature-verification-key</id>
          <keystore>data:application/pem;aes,v:S.b1lMaGN0YmNNZk9oTDNsdA==.r_yajVGjJ1xxgQvIQFEIMA==.3puq2tniQOYCTs7nDz_T1Vwyau9MVsbrSk0lgaR8mEjH9ZMlk21-ryMehe4DkyGmnVQ3ft8HxL137-sqns8w6g1P9AfEd4Lx7_aewxpcKe7HwwEAnAfydoXDlI9lqSawXx6uvcYx7cYkUL4kgwShJJLFIKcR6nWN7wOojzUN3nY408EBKH-D_U-TWTOYv-K_MpDOMdVItKid-rE_AXgc-z16nSAGBl0gjBXCOp5nRtZ6pBpO19fzNQWKJJXmmxGqQrg3KEZg0dtTCXYf8ikjb4LCwJWff52mnxkP9tloiIfSQdSnjsNcVluvv7RCxRO9QSKwHhqiNrVLDfl6kNGuwuHYMIH32aZBF51i61yWUH1nt4hcZfE7lkwU28QGeSITXZVLXy7zeb6NvoW_aqS0hkWDDMW8fVR0YHixTkv--_uil71lhRLSA-tb9zbnHHVAsL3kigFC0AN9kn6qn2e5Ws4z3n85d54aFrGgn1b66kEKQpySEA7kcm0aNgGq0wvwv05BqQv1m8GsgtTna5wKEX4FUXIfeYLvqah_vp9cVarFedNU_O4660bOKKWEd4glJBd9Xt-OCox_-lbxQ11_O9OIPF849nPfGqdFbvkBslbOjNivEXI6jRzCa8F3lVdj_K8mset935AUCeQhG_5nMyqLlZn7X8QOwOnHH4MVxkAUcvn4LRJfnOdmwmXZ807Dz8frZNAKNDxJUddMp1gSkMOfH71WYUHdMEdvuD86JJYD3EvhjtJQulhvPnPm0k_tY69neztshdfiOlDdyqFokahIuv7Pm4Io1L0X3T6LFzQ-0uuqOEJkFhsWwA5jMhCxbOHoriXXOtvM43ea185ubyiGlDuSBf6ze-afoV5knNFnJBvI-WjpYvbVeDxfsBMeulrBGrCvXjtGtgNdfxUm3fKhRA23KfYwZpG4LtJmfv9qL-ZeVRv2ZHFZRT5QVufckGSyz8SfwcIvlScpC71TuTIy1nFukThbmwIfUGmSv43MqSiO4yJS1MqXHHGyseCCVwYHdnbARXg5OL8jq0xAZh5wGVff38yIeNhGvFnTte6Mu5eS478r3w9P2YtdrhXusoYGeQ1xbZmcFJy0OzSM5NJ-2IQ9VNgawyY4UlAWZYQcWla2ZL6bl5VLt_b4qxxq0eKundi7HIpr6ndVdQv27OIZjYMGxN3gJPMSGsNeoMmRVhl7HzcRGXsKH9yBVZv8NQFZSH89JffnAo7byQihrlHYZvWiMlAgaB0_JuQqZw_tpEQyP5ZKS9gevNUQ3UGkH8LibBiVbSwoA3YXzOfAb0foPd8SY7oGmSu47FH9Zd0aqhddN9rKl4_vMq1Kp0tDQJuvR6g-l91705Sv3RlXH5nrM1Kh5NZghCKe1NfA-nNQTeiy3xqXSH-i_2axo8KaI2FYr5hKCluPAcu0kMGdu8pz5316ueHvKo4Cb1tK40XvJw3en-OMiHvOeT5gcdThQ3G2GU629BVULaWQevMSSsZMPrs8l8Jg5oxjAfY5lQ_oZfikRnp7ey2iP-8DkdCsMid7vsmU6mt_T_KtdvaXAX960XzvXwmkespW1mrRc1hNwanZZlc3l3SL6Rhp4lJe5-9u0n_b-78x7HCwndipUg==.wpJ-sr2161nPAlgj6hqoZljptGxaNmRHlUXiHqIAiEE=</keystore>
        </signature-verification-key>
      </signature-verification-keys>
    </crypto>
    <caching-services>
      <default-caching-service>
        <data-source>default-datasource</data-source>
      </default-caching-service>
    </caching-services>
  </facilities>
  <processing xmlns="https://curity.se/ns/conf/base">
    <license-key></license-key>
    <authorization-managers>
      <authorization-manager>
        <id>my-xacml-authz-manager</id>
        <xacml-authorization-manager xmlns="https://curity.se/ns/ext-conf/xacml-authorization-manager">
          <http-client>
            <id>xacml-http-client</id>
          </http-client>
          <pdphost>xacml-pdp</pdphost>
          <pdppath>/services/pdp</pdppath>
          <pdpport>8080</pdpport>
        </xacml-authorization-manager>
      </authorization-manager>
    </authorization-managers>
    <account-managers>
      <account-manager>
        <id>default-account-manager</id>
        <enable-registration>
          <account-verification-method>no-verification</account-verification-method>
        </enable-registration>
        <account-data-source>default-datasource</account-data-source>
      </account-manager>
    </account-managers>
    <credential-managers>
      <credential-manager>
        <id>default-credential-manager</id>
        <Sha2WithSha256>
        </Sha2WithSha256>
        <data-source-backed>
          <data-source-id>default-datasource</data-source-id>
        </data-source-backed>
      </credential-manager>
    </credential-managers>
  </processing>
  <nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm">
    <write-default>permit</write-default>
    <groups>
      <group>
        <name>admin</name>
        <user-name>admin</user-name>
      </group>
    </groups>
    <rule-list>
      <name>admin</name>
      <group>admin</group>
      <rule>
        <name>any-access</name>
        <action>permit</action>
      </rule>
    </rule-list>
    <rule-list>
      <name>any-group</name>
      <group>*</group>
      <rule>
        <name>tailf-aaa-authentication</name>
        <module-name>tailf-aaa</module-name>
        <path>/aaa/authentication/users/user[name='$USER']</path>
        <access-operations>read update</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-aaa-user</name>
        <module-name>tailf-aaa</module-name>
        <path>/user[name='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-webui-user</name>
        <module-name>tailf-webui</module-name>
        <path>/webui/data-stores/user-profile[username='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
    </rule-list>
  </nacm>
  <aaa xmlns="http://tail-f.com/ns/aaa/1.1">
    <authentication>
      <users>
        <user>
          <name>admin</name>
          <uid>0</uid>
          <gid>0</gid>
          <password>$5$iP3vJpIj$c.ZEStVuRenQvI.5P9DpBV9fNBs2E9ckBAhZ37Lsvh3</password>
          <ssh_keydir>/Users/iggbom/curity/idsvr-7.3.1-xacml/idsvr/home/admin/.ssh</ssh_keydir>
          <homedir>/Users/iggbom/curity/idsvr-7.3.1-xacml/idsvr/home/admin</homedir>
        </user>
      </users>
    </authentication>
    <ios>
      <level>
        <nr>0</nr>
        <prompt>\h> </prompt>
      </level>
      <level>
        <nr>15</nr>
        <prompt>\h# </prompt>
      </level>
      <privilege>
        <mode>exec</mode>
        <level>
          <nr>0</nr>
          <command>
            <name>action</name>
          </command>
          <command>
            <name>autowizard</name>
          </command>
          <command>
            <name>enable</name>
          </command>
          <command>
            <name>exit</name>
          </command>
          <command>
            <name>help</name>
          </command>
          <command>
            <name>startup</name>
          </command>
        </level>
        <level>
          <nr>15</nr>
          <command>
            <name>configure</name>
          </command>
        </level>
      </privilege>
    </ios>
  </aaa>
</config>